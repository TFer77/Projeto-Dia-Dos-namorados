<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TESTE FINAL DE √ÅUDIO</title>
    <style>
        /* CSS M√çNIMO S√ì PARA O TESTE FUNCIONAR */
        body { font-family: sans-serif; text-align: center; background-color: #333; color: white; }
        .capitulo {
            height: 100vh; /* Ocupa a altura inteira da tela */
            border-bottom: 2px solid white;
            display: flex;
            justify-content: center;
            align-items: center;
            font-size: 3em;
        }
        #capitulo1 { background-color: #003366; }
        #capitulo2 { background-color: #004488; }
        #capitulo3 { background-color: #0055AA; }
        #capitulo4 { background-color: #884400; }
        #capitulo5 { background-color: #AA5500; }
        #prologo { background-color: #002244; }
        button { font-size: 1.5em; padding: 20px; margin: 20px; cursor: pointer; }
    </style>
</head>
<body>

    <div class="container">
        <header>
            <h1>Feliz Primeiro Dia dos Namorados!</h1>
        </header>

        <div class="audio-controls">
            <audio id="audio-parte1" src="audio/Matue-AnosLuz.mp3" loop></audio>
            <audio id="audio-parte2" src="audio/Lisboa.mp3" loop></audio>
            <button id="botao-musica">Clique para ouvir nossa m√∫sica üé∂</button>
        </div>

        <main>
            <section class="card" id="mensagem-principal">
                <h2>Meu Amor,</h2>
                <p>Espero que tudo que eu tenha dado e feito nesse seu primeiro e t√£o especial momento tenha suprido suas espectativas minimamente, eu amo demais voc√™ e queria fazer essa pequena surpresinha para falar um pouco o quanto te amo e quero cada vez mais continuar te amando.</p>
            </section>

            <section class="card">
                <h2>Desculpa se algumas coisas estiverem bugadas ou feias, tentei ir ao m√°ximo no pelo</h2>
                <p>Gostosa de Lima da Silva Abaixo</p>
                <video id="video-surpresa" src="src/VID-20240901-WA0063.mp4" muted loop playsinline></video>
            </section>

            <section class="card" id="prologo">Pr√≥logo</section>
            <section class="capitulo" id="capitulo1">Cap√≠tulo 1: O Come√ßo</section>
            <section class="capitulo" id="capitulo2">Cap√≠tulo 2: A perdi√ß√£o</section>
            <section class="capitulo" id="capitulo3">Cap√≠tulo 3: O Reencontro</section>
            <section class="capitulo" id="capitulo4">Cap√≠tulo 4: O √çnicio do Fim</section>
            <section class="capitulo" id="capitulo5">CAP√çTULO 5 (M√∫sica 2)</section>


    <script>
        // SCRIPT DE DIAGN√ìSTICO FINAL
        document.addEventListener("DOMContentLoaded", () => {
            console.log("--- P√ÅGINA DE TESTE CARREGADA ---");

            const audio1 = document.getElementById("audio-parte1");
            const audio2 = document.getElementById("audio-parte2");
            const botaoMusica = document.getElementById("botao-musica");
            const capitulos = document.querySelectorAll(".capitulo");
            
            console.log("ELEMENTOS DE TESTE ENCONTRADOS:", { audio1, audio2, botaoMusica, capitulos });

            let musicaIniciada = false;

            botaoMusica.addEventListener("click", () => {
                console.log("--- BOT√ÉO CLICADO ---");
                musicaIniciada = true;
                botaoMusica.style.display = 'none';
                audio1.play().catch(error => console.error("ERRO AO INICIAR AUDIO 1:", error));
            });

            const observer = new IntersectionObserver((entries) => {
                console.log("--- OBSERVER ACIONADO ---", entries);

                if (!musicaIniciada) {
                    console.log("M√∫sica ainda n√£o iniciada, ignorando.");
                    return;
                }

                entries.forEach(entry => {
                    const chapterId = entry.target.id;
                    const isVisible = entry.isIntersecting;

                    console.log(`Cap√≠tulo: ${chapterId} | Est√° vis√≠vel? ${isVisible}`);

                    if (isVisible) {
                        console.log(`CONDI√á√ÉO 1 PASSOU: ${chapterId} est√° vis√≠vel.`);
                        
                        if (['prologo', 'capitulo1', 'capitulo2', 'capitulo3'].includes(chapterId)) {
                            console.log(`CONDI√á√ÉO 2 PASSOU: ${chapterId} √© da PARTE 1.`);
                            if (audio1.paused) {
                                console.log(`%cTENTANDO TOCAR √ÅUDIO 1`, 'color: lightgreen; font-weight: bold;');
                                audio2.pause();
                                audio1.play().catch(error => console.error("ERRO GRAVE AUDIO 1:", error));
                            }
                        } else if (['capitulo4', 'capitulo5'].includes(chapterId)) {
                            console.log(`CONDI√á√ÉO 2 PASSOU: ${chapterId} √© da PARTE 2.`);
                            if (audio2.paused) {
                                console.log(`%cTENTANDO TOCAR √ÅUDIO 2`, 'color: lightblue; font-weight: bold;');
                                audio1.pause();
                                audio2.play().catch(error => console.error("ERRO GRAVE AUDIO 2:", error));
                            }
                        }
                    }
                });
            }, { threshold: 0.8 }); // Usei um threshold alto (80%) para garantir que s√≥ um esteja ativo por vez

            capitulos.forEach(capitulo => {
                observer.observe(capitulo);
            });
        });
    </script>
</body>
</html>